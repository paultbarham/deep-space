machine:
  java:
    version:
      oraclejdk7
general:
  artifacts:
    - "target/ROOT.war"
compile:
  override:
    - mvn clean verify

deployment:
  production:
    branch: demo
    commands:
      # FTP deploy using curl
      # - "curl --ftp-create-dirs -T target/ROOT.war -u $azureFTPUser:$azureFTPPW ftp://$azureFTPSite/site/wwwroot/webapps/"
      
      # Alternate git repo deploy
      - mkdir -p newrepo/webapps
      - cp target/ROOT.war newrepo/webapps/ROOT.war
      - cd newrepo && git init 
      - cd newrepo && git config user.email "pabarham@microsoft.com"
      - cd newrepo && git config user.name "Paul T. Barham"
      - cd newrepo && git add webapps/ROOT.war
      - cd newrepo && git commit -m "commit ROOT.war"
      - cd newrepo && git remote add azure https://$azureUser:$azurePW@$azureSite.scm.azurewebsites.net:443/$azureSite.git
      #  Leave this line commented out - "[[ ! -s \"$(git rev-parse --git-dir)/shallow\" ]] || git fetch --unshallow"
      - cd newrepo && git push --force azure HEAD:master

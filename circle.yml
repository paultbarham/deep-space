machine:
  java:
    version:
      oraclejdk7
general:
  artifacts:
    - "target/ROOT.war"
compile:
  override:
    - mvn clean verify
# Azure WebApp Java Tomcat Git deployment
deployment:
  production:
    branch: demo
    commands:
      - mkdir -p newrepo/webapps
      - cp target/ROOT.war newrepo/webapps/ROOT.war
      - cd newrepo
      - git init 
      - git config user.email "pabarham@microsoft.com"
      - git config user.name "Paul T. Barham"
      - git add webapps/ROOT.war
      - git commit -m "commit ROOT.war"
      - git remote add azure https://$azureUser:$azurePW@$azureSite.scm.azurewebsites.net:443/$azureSite.git
      # - "[[ ! -s \"$(git rev-parse --git-dir)/shallow\" ]] || git fetch --unshallow"
      - git push --force azure HEAD:master
